(this["webpackJsonpreact-template"]=this["webpackJsonpreact-template"]||[]).push([[6],{135:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(83),n=r(169);function o(){var e=localStorage.getItem("refresh_token");return function(t){fetch("".concat("https://server.kidsdrawing.site/api/v1","/auth/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})}).then((function(e){if(!e.ok){if(500!==e.status)throw Error(e.statusText);var r=localStorage.getItem("id");t(Object(n.a)(r,{status:null})),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("username"),localStorage.removeItem("role"),localStorage.removeItem("id"),localStorage.removeItem("contest_id"),localStorage.removeItem("schedule_id"),t(Object(a.d)())}return e.json()})).then((function(e){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.setItem("access_token",e.accessToken),localStorage.setItem("refresh_token",e.refreshToken)})).catch((function(e){console.log("error")}))}}},140:function(e,t,r){"use strict";function a(e){this.message=e}a.prototype=new Error,a.prototype.name="InvalidCharacterError";var n="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,o=0,c=0,s="";n=t.charAt(c++);~n&&(r=o%4?64*r+n:n,o++%4)?s+=String.fromCharCode(255&r>>(-2*o&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return s};function o(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(n(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return n(t)}}function c(e){this.message=e}c.prototype=new Error,c.prototype.name="InvalidTokenError",t.a=function(e,t){if("string"!=typeof e)throw new c("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(o(e.split(".")[r]))}catch(e){throw new c("Invalid token specified: "+e.message)}}},145:function(e,t,r){"use strict";var a=r(137),n=r(2),o=r.n(n);t.a=function(e){var t=Object(n.useState)(!1),r=Object(a.a)(t,2),c=r[0],s=r[1],l=Object(n.useState)(""),i=Object(a.a)(l,2),u=i[0],d=i[1],m=Object(n.useState)(""),g=Object(a.a)(m,2),p=g[0],f=g[1],h=Object(n.useState)(""),v=Object(a.a)(h,2)[1];return o.a.createElement("div",null,o.a.createElement("label",{htmlFor:e.id.toString()},e.label),o.a.createElement("input",{value:e.value,type:e.type,onChange:function(t){var r=["","",t.target.value],n=r[0],o=r[1],l=r[2],i=!l&&e.required?["Value cannot be empty","is-invalid"]:["","is-valid"],u=Object(a.a)(i,2);if(n=u[0],o=u[1],!n){var m=e.maxLength&&l&&l.length>e.maxLength?["Value can't have more than ".concat(e.maxLength," characters"),"is-invalid"]:["","is-valid"],g=Object(a.a)(m,2);n=g[0],o=g[1]}e.onChange({value:l,error:n,touched:c,field:e.field}),s(!0),d(n),f(o),v(l)},className:"form-control ".concat(e.inputClass," ").concat(p),id:"id_".concat(e.label),placeholder:e.placeholder}),u?o.a.createElement("div",{className:"invalid-feedback"},u):null)}},169:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(10),n=r(135);function o(e,t){var r="Bearer "+localStorage.getItem("access_token");return function(c){c(Object(a.C)()),fetch("".concat("https://server.kidsdrawing.site/api/v1","/user/status/").concat(e),{method:"PUT",headers:{Authorization:r,"Content-Type":"application/json","Access-Control-Allow-Origin":"".concat("http://localhost:3000"),"Access-Control-Allow-Credentials":"true"},body:JSON.stringify(t)}).then((function(r){if(r.ok)return r;if(403!==r.status)throw Error(r.statusText);c(Object(n.a)()),c(o(e,t))})).then((function(r){console.log(r),console.log(e),c(Object(a.D)(t))})).catch((function(e){c(Object(a.B)(e)),console.log("error")}))}}},201:function(e,t,r){},752:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r(137),o=r(2),c=r.n(o),s=r(79),l=r(145),i=(r(201),r(140)),u=r(83),d=r(136),m=r(169);r(170);var g=r(35);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}t.default=function(){var e=Object(s.b)(),t=Object(g.g)(),r=Object(o.useState)({username:{error:"",value:""},password:{error:"",value:""}}),f=Object(n.a)(r,2),h=f[0],v=f[1];function b(e){!0===e&&t.push("/")}function O(e){v(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach((function(t){Object(a.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},h,Object(a.a)({},e.field,{error:e.error,value:e.value})))}function w(){return h.username.error||h.password.error||!h.username.value||!h.password.value}return c.a.createElement("div",{className:"container-fluid ",id:"login-page"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-xl-10 col-lg-10 col-md-9"},c.a.createElement("h2",{id:"text-logo",onClick:function(){t.push("/landing-page")}},"KidsDrawing"))),c.a.createElement(d.a,null),c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-xl-10 col-lg-12 col-md-9"},c.a.createElement("div",{className:"card o-hidden border-0  my-5"},c.a.createElement("div",{className:"card-body p-0"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-lg-6 d-none d-lg-block text-center",id:"image-login-page"},c.a.createElement("img",{src:"https://res.cloudinary.com/djtmwajiu/image/upload/v1667290306/o0ymcs4lblpy2hfmisyq.png",alt:"First slide"})),c.a.createElement("div",{className:"col-lg-6 shadow-lg"},c.a.createElement("div",{className:"p-5"},c.a.createElement("div",{className:"text-center"},c.a.createElement("h1",{className:"h4 text-gray-900 mb-4"},"\u0110\u0103ng nh\u1eadp")),c.a.createElement("form",{className:"user",onSubmit:function(t){if(t.preventDefault(),!w()){var r=d.b.loading("\u0110ang x\xe1c th\u1ef1c. Vui l\xf2ng \u0111\u1ee3i gi\xe2y l\xe1t...",{position:d.b.POSITION.TOP_CENTER});e(function(e,t,r,a){return function(n){fetch("".concat("https://server.kidsdrawing.site/api/v1","/auth"),{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"".concat("http://localhost:3000"),"Access-Control-Allow-Credentials":"true"},body:JSON.stringify({username:e,password:t})}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(t){localStorage.clear(),localStorage.setItem("access_token",t.accessToken),localStorage.setItem("refresh_token",t.refreshToken),localStorage.setItem("username",e);var o=t.accessToken,c=Object(i.a)(o);console.log(c),localStorage.setItem("role",c.role),localStorage.setItem("id",c.id),localStorage.setItem("link_profile",c.profile_image_url),n(Object(u.c)(e)),d.b.update(a,{render:"\u0110\u0103ng nh\u1eadp th\xe0nh c\xf4ng",type:"success",isLoading:!1,position:d.b.POSITION.TOP_CENTER,autoClose:1e3}),setTimeout((function(){r(!0)}),1e3);var s=indexedDB.open("firebase-messaging-database",1);s.onerror=function(){console.error("Error",s.error)},localStorage.setItem("path","/"),s.onsuccess=function(){var e=s.result;e.onversionchange=function(){e.close(),alert("Database is outdated, please reload the page.")},console.log(e);var t=e.transaction("firebase-messaging-store","readwrite").objectStore("firebase-messaging-store").getAll();t.onerror=function(){console.error("Error",s.error)},t.onsuccess=function(e){if(e.target.result){console.log(e.target.result);var t=e.target.result[0];n(Object(m.a)(localStorage.getItem("id"),{status:t.token}))}else console.log("The firebase device token with 0 not found")}}})).catch((function(e){d.b.update(a,{render:"\u0110\u0103ng nh\u1eadp kh\xf4ng th\xe0nh c\xf4ng",type:"error",isLoading:!1,position:d.b.POSITION.TOP_CENTER,closeButton:!0})}))}}(h.username.value,h.password.value,b,r))}}},c.a.createElement("div",{className:"form-group"},c.a.createElement(l.a,{id:"input_username",field:"username",value:h.username.value,onChange:O,required:!0,maxLength:100,label:"T\xean \u0111\u0103ng nh\u1eadp",placeholder:""})),c.a.createElement("div",{className:"form-group"},c.a.createElement(l.a,{id:"input_password",field:"password",value:h.password.value,onChange:O,required:!0,maxLength:100,type:"password",label:"M\u1eadt kh\u1ea9u",placeholder:""})),c.a.createElement("button",{className:"btn btn-primary btn-user btn-block ".concat(w()?"disabled":""),type:"submit"},"\u0110\u0103ng nh\u1eadp")),c.a.createElement("div",{className:"justify-content-center text-center"},c.a.createElement("p",{className:"link",style:{color:"#0066FF"},onClick:function(){t.push("/forgot-password")}},"Qu\xean m\u1eadt kh\u1ea9u?")),c.a.createElement("div",{className:"justify-content-center text-center"},c.a.createElement("p",null,"B\u1ea1n ch\u01b0a c\xf3 t\xe0i kho\u1ea3n? ",c.a.createElement("span",{style:{color:"#0066FF"}},c.a.createElement("span",{className:"link",style:{color:"#0066FF"},onClick:function(){t.push("/register")}},"\u0110\u0103ng k\xed"))))))))))))}}}]);
//# sourceMappingURL=6.4a09d7ae.chunk.js.map